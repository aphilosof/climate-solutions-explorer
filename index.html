<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Climate Solutions Explorer</title>
  <link rel="stylesheet" href="styles.css">
  <script src="https://d3js.org/d3.v7.min.js"></script>
  <script src="https://unpkg.com/compromise@latest/builds/compromise.min.js"></script>
  <script src="https://unpkg.com/compromise-dates@latest/builds/compromise-dates.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/minisearch@7.1.2/dist/umd/index.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>

</head>
<body>

  <!-- Header -->
  <div class="header">
    <h1 class="site-title">
      <!-- üåç Climate Solutions Explorer</h1> -->
      <a href="https://climatedrift.substack.com/" class="logo-link">
        <img src="cd_logo_crop_green.png" alt="Logo" class="site-logo">
      </a>
       Climate Solutions Explorer
  </h1>
    <p class="site-description" id="siteDescription">
      Explore and discover climate solutions. Use the search bar to find specific solutions,
      filter by type or tag, and switch between different visualizations.
      <a href="docs/FAQ.html" style="color: #40916c; text-decoration: none; border-bottom: 1px solid rgba(64, 145, 108, 0.5);">Learn more in the FAQ</a>.
      (Disclaimer - Currently only showing a small test dataset).
    </p>
  </div>

  <!-- Floating Menu Toggle Button -->
  <button class="sidebar-toggle" id="sidebarToggle" aria-label="Toggle menu">
    <span class="hamburger-icon">‚ò∞</span>
  </button>

  <!-- Floating Home Button (for all visualizations) -->
  <button class="home-toggle" id="homeToggle" aria-label="Reset to home view" style="display: none;">
    <span class="home-icon">‚åÇ</span>
  </button>

  <!-- Floating Up Button (go to parent level) -->
  <button class="up-toggle" id="upToggle" aria-label="Go up one level" style="display: none;">
    <span class="up-icon">‚Üë</span>
  </button>

  <!-- Floating Sidebar -->
  <div class="sidebar" id="sidebar">
    <div class="sidebar-header">
      <h3>Controls</h3>
      <button class="sidebar-close" id="sidebarClose" aria-label="Close menu">‚úï</button>
    </div>

    <div class="sidebar-content">
      <!-- Search -->
      <div class="sidebar-section">
        <label class="sidebar-label">Search</label>
        <div class="search-box">
          <input
            type="text"
            class="search-input"
            id="searchInput"
            placeholder="Search climate solutions..."
          >
          <div class="search-suggestions" id="searchSuggestions"></div>
          <div class="search-count" id="searchInfo">Loading...</div>
        </div>

        <!-- Advanced Search Toggle -->
        <button class="advanced-search-toggle" id="advancedSearchToggle">
          <span class="toggle-icon">‚öôÔ∏è</span>
          <span class="toggle-text">Advanced Search</span>
          <span class="toggle-arrow">‚ñº</span>
        </button>

        <!-- Advanced Search Panel -->
        <div class="advanced-search-panel" id="advancedSearchPanel" style="display: none;">
          <div class="advanced-search-header">
            <h4>Search Operators</h4>
          </div>
          <div class="advanced-search-content">
            <div class="search-help-item">
              <code>"exact phrase"</code>
              <span class="help-description">Search for exact phrase</span>
            </div>
            <div class="search-help-item">
              <code>-exclude</code>
              <span class="help-description">Exclude results containing term</span>
            </div>
            <div class="search-help-item">
              <code>solar AND wind</code>
              <span class="help-description">Results must contain both terms</span>
            </div>
            <div class="search-help-item">
              <code>solar OR wind</code>
              <span class="help-description">Results with either term</span>
            </div>
            <div class="search-help-item">
              <code>author:ClimateDrift</code>
              <span class="help-description">Search by author</span>
            </div>
            <div class="search-help-item">
              <code>type:article</code>
              <span class="help-description">Search by type</span>
            </div>
            <div class="search-help-item">
              <code>tag:renewable</code>
              <span class="help-description">Search by tag</span>
            </div>
            <div class="search-help-item">
              <code>date:2023</code>
              <span class="help-description">Search by year or range (2023-2024)</span>
            </div>
          </div>
          <div class="advanced-search-examples">
            <h4>Examples</h4>
            <div class="search-example" data-query='"solar power" author:ClimateDrift'>
              "solar power" author:ClimateDrift
            </div>
            <div class="search-example" data-query='renewable -fossil type:article'>
              renewable -fossil type:article
            </div>
            <div class="search-example" data-query='wind OR solar date:2023'>
              wind OR solar date:2023
            </div>
          </div>
        </div>
      </div>

      <!-- Reset Filters Button -->
      <div class="sidebar-section">
        <button class="reset-filters-btn" id="resetFilters" title="Clear all filters and search">
          <span>üîÑ</span>
          <span>Reset Filters</span>
        </button>
      </div>

      <!-- Viz Selector -->
      <div class="sidebar-section">
        <label class="sidebar-label">Visualization</label>
        <div class="selector">
          <button class="selector-btn" id="vizSelector">
            <span class="selector-value" id="vizValue">Sunburst</span>
            <span class="selector-arrow">‚ñº</span>
          </button>
          <div class="dropdown" id="vizDropdown">
            <button class="dropdown-option active" data-viz="circle" data-icon="‚≠ï" data-name="Circle Packing">
              <span class="option-icon">‚≠ï</span>
              <span>Circle Packing</span>
            </button>
            <button class="dropdown-option" data-viz="dendrogram" data-icon="üå≥" data-name="Dendrogram">
              <span class="option-icon">üå≥</span>
              <span>Dendrogram</span>
            </button>
            <button class="dropdown-option" data-viz="treemap" data-icon="üì¶" data-name="Treemap">
              <span class="option-icon">üì¶</span>
              <span>Treemap</span>
            <button class="dropdown-option" data-viz="sunburst" data-icon="‚òÄÔ∏è" data-name="Sunburst">
              <span class="option-icon">‚òÄÔ∏è</span>
              <span>Sunburst</span>
            </button>
            </button>
          </div>
        </div>
      </div>

      <!-- Filters -->
      <div class="sidebar-section">
        <label class="sidebar-label">Filters</label>

        <!-- Type Filter -->
        <div class="selector sidebar-selector">
          <button class="selector-btn" id="typeSelector">
            <span class="selector-label">Type:</span>
            <span class="selector-value" id="typeValue">All</span>
            <span class="selector-arrow">‚ñº</span>
          </button>
          <div class="dropdown" id="typeDropdown">
            <button class="dropdown-option active" data-type="all">All Types</button>
            <!-- Will be populated dynamically -->
          </div>
        </div>

        <!-- Tag Filter -->
        <div class="selector sidebar-selector">
          <button class="selector-btn" id="tagSelector">
            <span class="selector-label">Tag:</span>
            <span class="selector-value" id="tagValue">All</span>
            <span class="selector-arrow">‚ñº</span>
          </button>
          <div class="dropdown" id="tagDropdown">
            <button class="dropdown-option active" data-tag="all">All Tags</button>
            <!-- Will be populated dynamically -->
          </div>
        </div>

        <!-- Author Filter -->
        <div class="selector sidebar-selector">
          <button class="selector-btn" id="authorSelector">
            <span class="selector-label">Author:</span>
            <span class="selector-value" id="authorValue">All</span>
            <span class="selector-arrow">‚ñº</span>
          </button>
          <div class="dropdown" id="authorDropdown">
            <button class="dropdown-option active" data-author="all">All Authors</button>
            <!-- Will be populated dynamically -->
          </div>
        </div>

        <!-- Location Filter -->
        <div class="selector sidebar-selector">
          <button class="selector-btn" id="locationSelector">
            <span class="selector-label">Location:</span>
            <span class="selector-value" id="locationValue">All</span>
            <span class="selector-arrow">‚ñº</span>
          </button>
          <div class="dropdown" id="locationDropdown">
            <button class="dropdown-option active" data-location="all">All Locations</button>
            <!-- Will be populated dynamically -->
          </div>
        </div>

        <!-- Date Range Filter -->
        <div class="date-range-filter">
          <label class="date-range-label">Date Range</label>
          <div class="date-inputs">
            <div class="date-input-group">
              <label class="date-label">From:</label>
              <input type="date" id="dateFrom" class="date-input">
            </div>
            <div class="date-input-group">
              <label class="date-label">To:</label>
              <input type="date" id="dateTo" class="date-input">
            </div>
          </div>
        </div>
      </div>

      <!-- My Favorites Section -->
      <div class="sidebar-section">
        <label class="sidebar-label">My Favorites (<span id="favoritesCount">0</span>)</label>
        <div id="favoritesContainer" class="favorites-container">
          <div class="favorites-empty">No favorites yet. Click the ‚≠ê button when viewing a solution to add it to your favorites.</div>
        </div>
        <div class="favorites-actions">
          <button class="favorites-action-btn" id="exportFavoritesBtn" title="Export favorites as JSON" style="display: none;">
            <span>üì§</span>
            <span>Export Favorites</span>
          </button>
          <button class="favorites-action-btn" id="clearFavoritesBtn" title="Clear all favorites" style="display: none;">
            <span>üóëÔ∏è</span>
            <span>Clear All</span>
          </button>
        </div>
      </div>

      <!-- Export Section -->
      <div class="sidebar-section">
        <label class="sidebar-label">Export</label>
        <div class="export-buttons-grid">
          <button class="export-btn sidebar-export-btn" id="exportJSON">
            <span>üìÑ</span>
            <span>JSON</span>
          </button>
          <button class="export-btn sidebar-export-btn" id="exportCSV">
            <span>üìä</span>
            <span>CSV</span>
          </button>
          <button class="export-btn sidebar-export-btn" id="exportSVG">
            <span>üñºÔ∏è</span>
            <span>SVG</span>
          </button>
          <button class="export-btn sidebar-export-btn" id="exportPNG">
            <span>üì∑</span>
            <span>PNG</span>
          </button>
        </div>
      </div>
    </div>
  </div>

  <!-- Sidebar Overlay (to close sidebar when clicking outside) -->
  <div class="sidebar-overlay" id="sidebarOverlay"></div>

  <!-- Loading Overlay -->
  <div class="loading-overlay" id="loadingOverlay">
    <div class="loading-spinner">
      <div class="spinner-circle"></div>
      <div class="spinner-icon">üåç</div>
    </div>
    <div class="loading-text" id="loadingText">Loading...</div>
  </div>

  <!-- Breadcrumb Navigation -->
  <nav class="breadcrumb-nav" id="breadcrumbNav" style="display: none;">
    <div class="breadcrumb-container">
      <button class="breadcrumb-item breadcrumb-home" id="breadcrumbHome" title="Go to root">
        <span class="breadcrumb-icon">üè†</span>
        <span class="breadcrumb-text">Climate Solutions</span>
      </button>
      <div class="breadcrumb-trail" id="breadcrumbTrail">
        <!-- Dynamically populated breadcrumb items -->
      </div>
    </div>
  </nav>

  <!-- Visualization -->
  <div class="viz-area">
    <div id="visualization">
      <div class="loading">
        <div class="loading-icon">üåç</div>
        <div class="loading-text">Loading Data</div>
      </div>
    </div>
  </div>

  <!-- Footer -->
  <div class="footer">
    <div class="footer-left">
      <span>¬© 2025 copyright</span>
      <a href="mailto:contact@example.com">üìß Contact</a>
      <a href="https://github.com/aphilosof/climate-solutions-explorer" target="_blank">
        ‚≠ê GitHub
      </a>
      <a href="https://forms.gle/uNyqmvkd6XGxRq38A">üí°Suggest an entry</a>
    </div>
  </div>

  <!-- Tooltip -->
  <div class="tooltip" id="tooltip">
    <div class="tooltip-name"></div>
    <div class="tooltip-details"></div>
  </div>

  <!-- Side Panel for Detailed Content -->
  <div class="side-panel" id="sidePanel">
    <!-- Content will be dynamically inserted here -->
  </div>

  <!-- UI Enhancement Script -->
  <script>
    // Auto-hide description after 6 seconds
    let descriptionHidden = false;
    setTimeout(() => {
      const description = document.getElementById('siteDescription');
      if (description) {
        description.style.maxHeight = '0';
        description.style.opacity = '0';
        description.style.marginBottom = '0';
        descriptionHidden = true;
      }
    }, 6000);

    // Click site title to show description again
    const siteTitle = document.querySelector('.site-title');
    if (siteTitle) {
      siteTitle.style.cursor = 'pointer';
      siteTitle.addEventListener('click', () => {
        const description = document.getElementById('siteDescription');
        if (description && descriptionHidden) {
          description.style.maxHeight = '100px';
          description.style.opacity = '1';
          description.style.marginBottom = '15px';
          descriptionHidden = false;
          // Auto-hide again after 6 seconds
          setTimeout(() => {
            description.style.maxHeight = '0';
            description.style.opacity = '0';
            description.style.marginBottom = '0';
            descriptionHidden = true;
          }, 6000);
        }
      });
    }

    // Sidebar toggle functionality
    const sidebar = document.getElementById('sidebar');
    const sidebarToggle = document.getElementById('sidebarToggle');
    const sidebarClose = document.getElementById('sidebarClose');
    const sidebarOverlay = document.getElementById('sidebarOverlay');

    function openSidebar() {
      sidebar.classList.add('open');
      sidebarOverlay.classList.add('active');
      document.body.style.overflow = 'hidden'; // Prevent body scroll when sidebar open
    }

    function closeSidebar() {
      sidebar.classList.remove('open');
      sidebarOverlay.classList.remove('active');
      document.body.style.overflow = ''; // Restore body scroll
    }

    if (sidebarToggle) {
      sidebarToggle.addEventListener('click', openSidebar);
    }

    if (sidebarClose) {
      sidebarClose.addEventListener('click', closeSidebar);
    }

    if (sidebarOverlay) {
      sidebarOverlay.addEventListener('click', closeSidebar);
    }

    // Close sidebar on Escape key
    document.addEventListener('keydown', (e) => {
      if (e.key === 'Escape' && sidebar.classList.contains('open')) {
        closeSidebar();
      }
    });

    // Home button functionality
    // The home button will trigger a custom event that visualizations can listen to
    const homeToggle = document.getElementById('homeToggle');
    if (homeToggle) {
      homeToggle.addEventListener('click', () => {
        // Dispatch custom event that visualizations can listen to
        window.dispatchEvent(new CustomEvent('resetVisualization'));
      });
    }

    // DISABLED - Home and up button functionality
    // Uncomment to re-enable home and up arrow navigation buttons
    /*
    // Show/hide home button based on visualization changes
    // This will be called by main.js after rendering a visualization
    window.showHomeButton = function() {
      if (homeToggle) {
        homeToggle.style.display = 'flex';
      }
    };

    window.hideHomeButton = function() {
      if (homeToggle) {
        homeToggle.style.display = 'none';
      }
    };

    // Up button functionality (go to parent level)
    const upToggle = document.getElementById('upToggle');
    if (upToggle) {
      upToggle.addEventListener('click', () => {
        // Dispatch custom event that visualizations can listen to
        window.dispatchEvent(new CustomEvent('goUpLevel'));
      });
    }

    // Show/hide up button based on visualization changes
    window.showUpButton = function() {
      if (upToggle) {
        upToggle.style.display = 'flex';
      }
    };

    window.hideUpButton = function() {
      if (upToggle) {
        upToggle.style.display = 'none';
      }
    };
    */
  </script>

  <!-- Main Application Script -->
  <script type="module" src="js/main.js?v=20251228-nobuttons"></script>
</body>
</html>
